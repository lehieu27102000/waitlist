(()=>{if("undefined"==typeof jQuery){const e=document.createElement("script");e.src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js",e.onload=function(){t()},document.head.appendChild(e)}else t();function t(){jQuery(document).ready((function(t){const e=".c7-waitlist",o="form",i=".waitlist-notification";var a={baseUrl:"https://api.commerce7.com/v1",tenantId:t("#waitlist-javascript").data("tenant"),credentials:btoa("waitlist:qsoINUkmk1vVLVhzN3M0zYlf2goxXixT06iRXt9X9jBBF624cbuvv38RvjpwXmVo")};async function s(t,e=null,o="GET"){try{const i="GET"===o&&e?"?"+new URLSearchParams(e).toString():"",s=await fetch(`${a.baseUrl}${t}${i}`,{method:o,headers:{Authorization:`Basic ${a.credentials}`,tenant:a.tenantId,"Content-Type":"application/json"},body:"POST"===o?JSON.stringify(e):null});if(!s.ok)throw new Error("Commerce7 Response Error");return await s.json()}catch(t){throw console.error("API Error:",t),t}}async function r(t,e,o,i){const s=t.split("/"),r=s.pop()||s.pop(),c=n("customerToken");try{const t=await async function(t){if(!t||!a.tenantId)return{success:!1,data:null};try{const e=await fetch(`${a.baseUrl}/customer/self`,{method:"GET",headers:{Authorization:t,tenant:a.tenantId,"Content-Type":"application/json"}});if(!e.ok)throw new Error("API request failed");return{success:!0,data:await e.json()}}catch(t){return console.error("Error fetching customer data:",t),{success:!1,data:null}}}(c);let s="";if(!t.success)return e||o||(s+='<h5 class="product-soldout">Sold Out</h5>'),void i(s);e||o||(s+='<h5 class="product-soldout">Sold Out</h5>'),s+=`<button class="button primary show-waitlist-modal" data-title="${r}">join waitlist</button>`,i(s)}catch(t){console.error("Error rendering waitlist content:",t),i("")}}const n=t=>{for(var e=t+"=",o=decodeURIComponent(document.cookie).split(";"),i=0;i<o.length;i++){for(var a=o[i];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(e))return a.substring(e.length,a.length)}return""};jQuery(document).on("click",".show-waitlist-modal",(function(t){jQuery(".c7-product-popup-close").click();const e='<div class="waitlist-modal-wrapper" id="waitlist-modal"><div class="waitlist-modal-content"><span class="close-wailtlist-modal">+</span><h2>Waitlist Signup</h2><p>Please add your email address below and we will notify you when this is available for purchase.</p><div class="waitlist-form"><label>Email Address *</label><input type="email" class="waitlist-email"><p class="waitlist-notification"></p><div class="button primary waitlist-submit" data-title="'+jQuery(this).data("title")+'">Submit</div></div></div></div>';jQuery("body").append(e)})),jQuery(document).on("click",".waitlist-submit",(async function(){try{const t=jQuery(".waitlist-email").val(),e=jQuery(this).data("title");if(jQuery(i).html(""),!function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}(t))return void jQuery(i).html("Input valid email address.");const o=await s("/customer/",{q:t});let a;a=0===o.total?(await s("/customer/",{emails:[{email:t}]},"POST")).id:o.customers[0].id;const r=`Waitlist: ${e}`,n=await s("/tag/customer/",{q:r});let c;c=0===n.total?(await s("/tag/customer/",{title:r,type:"Manual"},"POST")).id:n.tags[0].id,await s("/tag-x-object/customer/",{objectId:a,tagId:c},"POST"),jQuery(".waitlist-form").html("Received! You're on the list!")}catch(t){jQuery(i).html("System is busy at this moment. Please try again later.")}})),jQuery(document).on("click",".close-wailtlist-modal",(function(){jQuery(".waitlist-modal-wrapper").remove()})),(()=>{const t=document.querySelectorAll(".c7-product-collection");t&&t.forEach((t=>{new MutationObserver(((i,a)=>{const s=t.querySelectorAll(".c7-product");s&&(s.forEach((t=>{const i=t.querySelector(e),a=t.querySelector(o),s=t.querySelector(".c7-message"),n=t.querySelector(".c7-product__login-message");a||r(t.querySelector("a").getAttribute("href"),s,n,(function(t){i.innerHTML=t}))})),a.disconnect())})).observe(t,{childList:!0,subtree:!0})}));const i=document.getElementById("c7-content");i&&window.location.href.includes("/product/")&&new MutationObserver(((t,a)=>{const s=document.querySelector(e);if(s){const t=i.querySelector(o),e=i.querySelector(".c7-message"),n=i.querySelector(".c7-product__login-message");t||r(window.location.href,e,n,(function(t){s.innerHTML=t})),a.disconnect()}})).observe(i,{childList:!0,subtree:!0})})()}))}})();
//# sourceMappingURL=waitlist.min.js.map